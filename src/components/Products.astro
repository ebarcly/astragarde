---
import { z } from "zod";
import { ProductResult } from "../utils/schemas";
import ProductCard from "./ProductCard.astro";

const ProductsResult = z.array(ProductResult);
export interface Props {
  products: z.infer<typeof ProductsResult>;
  gap?: number;
  layout?: 'horizontal' | 'grid';
}
const { products, gap = 4, layout = 'grid' } = Astro.props as Props;
---

<section>
  <div class="container py-16 sm:py-20">
    <h2 class="sr-only">Products</h2>

    {layout === 'horizontal' ? (
      <div class={`flex flex-row gap-${gap ?? 2} overflow-x-auto w-screen -mx-4 sm:-mx-8 md:-mx-16 lg:-mx-32 px-0 scrollbar-none`} style="scrollbar-width: none;">
        {products.map((product) => (
          <div class="min-w-[170px] sm:min-w-[220px] md:min-w-[260px] lg:min-w-[300px] max-w-[90vw] flex-shrink-0 bg-white rounded-lg shadow-sm overflow-hidden flex flex-col h-full">
            <ProductCard product={product} />
          </div>
        ))}
      </div>
    ) : (
      <div class={`grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-${gap}`}>
        {products.map((product) => (
          <div>
            <ProductCard product={product} />
          </div>
        ))}
      </div>
    )}
  </div>
</section>

<style>
  .scrollbar-none::-webkit-scrollbar {
    display: none;
  }
  .scrollbar-none {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
</style>
